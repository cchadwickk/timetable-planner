<div *ngIf="data.length">
    <p-table [value]="data" [dataKey]="[uniqueKey]">
        <ng-template pTemplate="caption">
                {{heading}}
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th></th>
                <th *ngFor="let heads of filteredKeys()">
                    {{heads.toUpperCase()}}
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-expanded="expanded">
            <tr>
                <td>
                    <button type="button" pButton pRipple [pRowToggler]="rowData" class="p-button-text p-button-rounded p-button-plain">+</button>
                </td>
                <td *ngFor="let heads of filteredKeys()">
                    {{rowData[heads]}}
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-rowData>
            <tr>
                <td colspan="9">
                    <p-table [value]="[rowData]" [dataKey]="[uniqueKey]">
                        <ng-template pTemplate="caption">
                                REMAINING INFORMATION
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr>
                                <th *ngFor="let heads of remainingKeys()">
                                    {{heads.toUpperCase()}}
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData>
                            <tr>
                                <td *ngFor="let heads of remainingKeys()">
                                    {{rowData[heads]}}
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </td>
            </tr>
            <tr *ngIf="rowData.reviews && rowData.reviews.length">
                <td colspan="9">
                    <p-table [value]="rowData.reviews" [dataKey]="['reviewerEmail']">
                        <ng-template pTemplate="caption">
                            REVIEWS
                        </ng-template>
                        <ng-template pTemplate="header">
                            <tr>
                                <th *ngFor="let item of rowData.reviews[0] | keyvalue">
                                    {{item.key.toUpperCase()}}
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-reviewData>
                            <tr>
                                <td *ngFor="let item of reviewData | keyvalue">
                                    {{item.value}}
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div> 